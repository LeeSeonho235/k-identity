<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>K-Identity: Find Your Name</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4002075177790525"
     crossorigin="anonymous"></script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .track {
      width: 100%; height: 50px; position: relative;
      background: #f1f5f9; border-radius: 25px; overflow: hidden; border: 2px solid #e2e8f0;
    }
    #tiger {
      position: absolute; left: 0; top: 50%; transform: translateY(-50%);
      font-size: 28px; transition: left 0.5s linear; z-index: 10;
    }
    .rabbit {
      position: absolute; right: 15px; top: 50%; transform: translateY(-50%); font-size: 28px;
    }
    .scale-in { animation: scaleIn 0.3s ease-out; }
    @keyframes scaleIn {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
  </style>
</head>

<body class="bg-slate-50 min-h-screen p-6">

  <!-- âœ… ì „ì²´ ë ˆì´ì•„ì›ƒ: ì¹´ë“œê°€ í™”ë©´ ì •ì¤‘ì•™ + ì•„ë˜ì— ë²„íŠ¼/í‘¸í„° -->
  <div class="min-h-screen flex flex-col items-center justify-center gap-6">

    <!-- âœ… ë©”ì¸ ì¹´ë“œ (ê°€ìš´ë° ê³ ì •) -->
    <div class="bg-white max-w-md w-full rounded-[2.5rem] shadow-2xl p-10 space-y-8 relative overflow-hidden">

      <div class="absolute top-6 right-8">
        <select id="lang" class="text-xs bg-slate-50 border-none rounded-lg px-2 py-1 outline-none text-slate-500 cursor-pointer font-bold hover:bg-slate-100 transition-all">
          <option value="en">ğŸ‡ºğŸ‡¸ English</option>
          <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
          <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
          <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
        </select>
      </div>

      <div class="text-center">
        <h1 class="text-3xl font-black text-slate-800 tracking-tighter">ğŸ‡°ğŸ‡· K-Identity</h1>
        <p class="text-slate-500 mt-2 text-sm italic">Get a meaningful name for your soul.</p>
      </div>

      <div class="space-y-4">
        <div class="flex gap-2">
          <select id="strategy" class="flex-1 px-4 py-3 rounded-xl border-2 border-slate-50 text-xs font-bold text-slate-400 outline-none bg-slate-50/50">
            <option value="meaning">Focus: Meaning (Origin)</option>
            <option value="phonetic">Focus: Sound (Similar)</option>
          </select>
        </div>

        <input type="text" id="engName" placeholder="Enter name (Any language)"
               class="w-full px-6 py-4 rounded-2xl border-2 border-slate-100 focus:border-blue-500 outline-none transition-all text-center font-bold" />

        <div class="flex gap-3">
          <select id="gender" class="flex-1 px-4 py-4 rounded-2xl border-2 border-slate-100 outline-none bg-white font-medium">
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="unisex">Unisex</option>
          </select>
          <select id="vibe" class="flex-1 px-4 py-4 rounded-2xl border-2 border-slate-100 outline-none bg-white font-medium">
            <option value="Cool & Charismatic">Cool</option>
            <option value="Lovely & Sweet">Lovely</option>
            <option value="Elegant & Calm">Elegant</option>
          </select>
        </div>

        <button onclick="generate()"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-black py-5 rounded-2xl shadow-lg transform active:scale-[0.98] text-lg transition-all">
          Find My Name âœ¨
        </button>

        <p class="text-center text-[10px] text-slate-400 font-bold uppercase tracking-widest">
          Credits: <span id="creditDisplay" class="text-blue-500">0</span> Left
        </p>
      </div>

      <div id="loading" class="hidden text-center space-y-6 py-6">
        <div class="track">
          <div id="tiger">ğŸ¯</div>
          <div class="rabbit">ğŸ‡</div>
        </div>
        <div class="space-y-2">
          <h3 class="text-lg font-black text-slate-800 tracking-tight uppercase">Tiger is chasing your name... ğŸ¯ğŸ’¨</h3>
          <p class="text-blue-500 font-bold text-xs uppercase animate-pulse">Estimated time: 0.5 mins</p>
          <p class="text-slate-400 text-[10px] font-bold tracking-widest uppercase">Please Wait <span id="countdown">30</span>s</p>
        </div>
      </div>

      <div id="resultSection" class="hidden space-y-6 pt-4 border-t-2 border-slate-50 scale-in">
        <div id="captureArea" class="bg-blue-50 p-8 rounded-[2.5rem] text-center space-y-6 shadow-inner">
          <div id="imageContainer" class="relative w-40 h-40 mx-auto">
            <img id="aiImage" crossorigin="anonymous"
                 class="w-40 h-40 rounded-full shadow-2xl border-4 border-white object-cover hidden" src="" />
            <div id="imagePlaceholder"
                 class="w-40 h-40 rounded-full bg-slate-200 flex items-center justify-center text-4xl border-4 border-white shadow-inner">
              ğŸ‘¤
            </div>
          </div>

          <h2 id="kNameResult"
              class="text-3xl font-black text-slate-800 tracking-tight whitespace-nowrap overflow-x-hidden text-ellipsis px-4 pt-2 pb-3 leading-[1.15]">
          </h2>

          <div class="space-y-3 bg-white/60 p-6 rounded-3xl shadow-sm">
            <p id="hanjaMeaning" class="text-blue-600 font-black text-xs uppercase tracking-widest"></p>
            <p id="explainResult" class="text-slate-700 leading-relaxed text-sm font-medium"></p>
          </div>
        </div>

        <div class="space-y-2">
          <button onclick="downloadCard()"
                  class="w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-black rounded-2xl shadow-lg hover:brightness-110 transition-all text-sm">
            Download Card
          </button>
        </div>
      </div>

    </div>

    <!-- âœ… What is K-Identity? ë²„íŠ¼ (Privacy Policyì²˜ëŸ¼ â€œëª¨ë‹¬â€ë¡œ ëœ¨ê²Œ) -->
    <button type="button"
            onclick="openModal('about')"
            class="text-slate-700 font-black underline underline-offset-4 hover:text-slate-900 transition">
      What is K-Identity?
    </button>

    <!-- âœ… Footer -->
    <footer class="text-center text-sm text-slate-500 font-semibold">
      <button type="button" onclick="openModal('privacy')" class="underline hover:text-slate-700 mr-4">
        Privacy Policy
      </button>
      <button type="button" onclick="openModal('terms')" class="underline hover:text-slate-700">
        Terms of Service
      </button>
    </footer>
  </div>

  <!-- âœ… Universal Modal (about / privacy / terms ë‹¤ ì—¬ê¸°ë¡œ) -->
  <div id="modal" class="hidden fixed inset-0 z-[9999]">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModalUniversal()"></div>

    <div class="relative mx-auto mt-10 mb-10 w-[min(900px,92vw)] bg-white rounded-3xl shadow-2xl overflow-hidden">
      <div class="flex items-center justify-between px-6 py-4 border-b">
        <h2 id="modalTitle" class="text-lg font-black text-slate-800">Modal</h2>
        <button type="button" onclick="closeModalUniversal()"
                class="w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 text-slate-700 font-black">
          âœ•
        </button>
      </div>

      <div id="modalBody" class="px-6 py-6 max-h-[75vh] overflow-auto text-slate-700 leading-relaxed"></div>
    </div>
  </div>

  <!-- âœ… Modal Contents (hidden) -->
  <div class="hidden">

    <!-- About -->
    <div id="aboutContent">
      <h2 class="text-2xl font-black text-slate-800 mb-4">What is K-Identity?</h2>
      <p class="mb-4">
        K-Identity is a Korean name generator designed for people who are interested in Korean culture,
        language, and personal identity. By analyzing pronunciation, meaning, and cultural context,
        this tool suggests Korean names that feel natural and meaningful.
      </p>

      <h3 class="text-xl font-bold text-slate-800 mt-8 mb-3">How does this Korean name generator work?</h3>
      <p class="mb-4">
        Users enter a name or keyword in any language and choose preferences such as gender and style.
        The generator then creates a Korean name suggestion along with its meaning and explanation.
        This process is intended for cultural exploration and entertainment purposes.
      </p>

      <h3 class="text-xl font-bold text-slate-800 mt-8 mb-3">Who is this tool for?</h3>
      <ul class="list-disc pl-6 mb-4">
        <li>People learning Korean or interested in Korean names</li>
        <li>Fans of Korean culture, K-dramas, and K-pop</li>
        <li>Writers and creators looking for authentic Korean character names</li>
        <li>Anyone who wants a fun and meaningful Korean name</li>
      </ul>

      <h3 class="text-xl font-bold text-slate-800 mt-8 mb-3">Disclaimer</h3>
      <p class="text-sm text-slate-500">
        This service provides name suggestions for entertainment and cultural interest purposes only.
        The generated names are not legally binding or officially registered names.
      </p>
    </div>

    <!-- Privacy -->
    <div id="privacyContent">
      <p class="text-sm text-slate-500"><strong>Last updated:</strong> 2026-01-22</p>
      <p class="mt-4">
        This Privacy Policy explains how this website (â€œweâ€, â€œourâ€, â€œthe Serviceâ€) collects, uses, and shares information
        when you use our Korean name generator.
      </p>

      <h3 class="mt-6 text-base font-extrabold text-slate-800">Information We Collect</h3>
      <ul class="mt-2 list-disc pl-5 space-y-1">
        <li><strong>Information you provide:</strong> Text you enter to generate name suggestions (e.g., preferred name, keywords).</li>
        <li><strong>Log data:</strong> Basic technical data such as browser type, device information, and approximate location derived from IP address (standard server logs).</li>
        <li><strong>Cookies / similar technologies:</strong> We may use cookies for site functionality, analytics, and advertising.</li>
      </ul>

      <h3 class="mt-6 text-base font-extrabold text-slate-800">How We Use Information</h3>
      <ul class="mt-2 list-disc pl-5 space-y-1">
        <li>To provide and improve the Service (e.g., generating name suggestions, fixing bugs, improving performance).</li>
        <li>To understand usage and improve user experience (analytics).</li>
        <li>To display advertising, including Google ads, if enabled.</li>
      </ul>

      <h3 class="mt-6 text-base font-extrabold text-slate-800">Advertising (Google AdSense)</h3>
      <p class="mt-2">
        We may use Google AdSense to show ads. Google and its partners may use cookies to serve ads based on your visits to this
        and/or other sites.
      </p>

      <h3 class="mt-6 text-base font-extrabold text-slate-800">Contact</h3>
      <p class="mt-2">
        If you have questions about this Privacy Policy, contact us at: <strong>dltjsgh0246@naver.com</strong>
      </p>
    </div>

    <!-- Terms -->
    <div id="termsContent">
      <p class="text-sm text-slate-500"><strong>Last updated:</strong> 2026-01-22</p>

      <p class="mt-4">
        By accessing or using this website (the â€œServiceâ€), you agree to these Terms of Service.
        If you do not agree, please do not use the Service.
      </p>

      <h3 class="mt-6 text-base font-extrabold text-slate-800">Service Description</h3>
      <p class="mt-2">
        The Service provides Korean name suggestions for entertainment and cultural interest purposes.
      </p>

      <h3 class="mt-6 text-base font-extrabold text-slate-800">Contact</h3>
      <p class="mt-2">
        Questions about these Terms: <strong>dltjsgh0246@naver.com</strong>
      </p>
    </div>
  </div>

  <!-- Recharge Modal (ë„ˆ ì½”ë“œ ìœ ì§€) -->
  <div id="rechargeModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-6 z-50">
    <div class="bg-white w-full max-w-sm rounded-[2.5rem] p-10 text-center space-y-6 shadow-2xl scale-in relative">

      <button onclick="closeRechargeModal()" aria-label="Close"
              class="absolute top-4 right-4 w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 text-slate-600 font-black flex items-center justify-center transition-all">
        âœ•
      </button>

      <h3 class="text-2xl font-black text-slate-800 tracking-tighter uppercase">Energy Depleted! ğŸ”‹</h3>
      <p class="text-slate-500 text-sm italic">Get more credits to find more names:</p>

      <div class="space-y-3">
        <a href="https://www.buymeacoffee.com/seonho" target="_blank" onclick="buyCredits(3)"
           class="block w-full py-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold rounded-2xl transition-all text-sm text-center">
          ğŸ’¸ Try 3 more names ($1)
        </a>

        <a href="https://www.buymeacoffee.com/seonho" target="_blank" onclick="buyCredits(20)"
           class="block w-full py-4 bg-yellow-400 hover:bg-yellow-500 text-slate-900 font-black rounded-2xl transition-all shadow-md text-center">
          â˜•ï¸ Full Pack - 20 names ($3)
        </a>

        <a href="https://www.buymeacoffee.com/seonho" target="_blank" onclick="buyCredits(50)"
           class="block w-full py-4 bg-blue-50 hover:bg-blue-100 text-blue-600 font-bold rounded-2xl transition-all text-sm text-center">
          ğŸ Family Pack - 50 names ($5)
        </a>

        <div class="pt-2 flex flex-col gap-2">
          <button onclick="shareOnInsta()" class="w-full py-3 bg-pink-50 text-pink-600 font-bold rounded-xl text-xs">
            ğŸ“¸ Share for +3 Credits
          </button>
          <button onclick="startAdTimer()" id="adBtn"
                  class="w-full py-2 text-slate-400 text-[10px] font-bold underline italic uppercase tracking-widest">
            Or watch 30s ad for 1 credit
          </button>
        </div>
      </div>

      <button onclick="closeRechargeModal()"
              class="text-slate-500 text-[11px] font-bold uppercase tracking-widest hover:text-slate-700 transition-all">
        Back to Results
      </button>
    </div>
  </div>

  <script>
    /* =========================================================
       âœ… 0. Universal Modal (about/privacy/terms)
       ========================================================= */
    function openModal(type) {
      const modal = document.getElementById('modal');
      const title = document.getElementById('modalTitle');
      const body = document.getElementById('modalBody');

      if (type === 'about') {
        title.textContent = 'What is K-Identity?';
        body.innerHTML = document.getElementById('aboutContent').innerHTML;
        location.hash = 'about';
      } else if (type === 'privacy') {
        title.textContent = 'Privacy Policy';
        body.innerHTML = document.getElementById('privacyContent').innerHTML;
        location.hash = 'privacy';
      } else {
        title.textContent = 'Terms of Service';
        body.innerHTML = document.getElementById('termsContent').innerHTML;
        location.hash = 'terms';
      }

      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closeModalUniversal() {
      const modal = document.getElementById('modal');
      modal.classList.add('hidden');
      document.body.style.overflow = '';

      if (location.hash === '#about' || location.hash === '#privacy' || location.hash === '#terms') {
        history.replaceState(null, '', location.pathname + location.search);
      }
    }

    window.addEventListener('load', () => {
      if (location.hash === '#about') openModal('about');
      if (location.hash === '#privacy') openModal('privacy');
      if (location.hash === '#terms') openModal('terms');
    });

    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        const modal = document.getElementById('modal');
        if (!modal.classList.contains('hidden')) closeModalUniversal();
      }
    });

    /* =========================================================
       âœ… 1. Credit Logic
       ========================================================= */
    if (!localStorage.getItem('k_credits')) localStorage.setItem('k_credits', '1');
    updateCreditUI();

    function getCredits() { return parseInt(localStorage.getItem('k_credits') || '0', 10); }
    function updateCreditUI() { document.getElementById('creditDisplay').innerText = localStorage.getItem('k_credits') || '0'; }

    function recharge(amount) {
      const current = getCredits();
      const next = current + amount;
      localStorage.setItem('k_credits', next.toString());
      updateCreditUI();
      console.log(`Credit Updated: ${current} -> ${next}`);
    }

    /* =========================================================
       âœ… 2. Recharge modal controls
       ========================================================= */
    function showRechargeModal() { document.getElementById('rechargeModal').classList.remove('hidden'); }
    function closeRechargeModal() { document.getElementById('rechargeModal').classList.add('hidden'); }

    /* =========================================================
       âœ… 3. Tiger loading animation
       ========================================================= */
    let progressIdx;

    function startTigerMotion() {
      let leftPos = 0; let seconds = 30;
      const tiger = document.getElementById('tiger');
      const countdown = document.getElementById('countdown');
      tiger.style.left = "0%";
      progressIdx = setInterval(() => {
        leftPos += 3; seconds--;
        tiger.style.left = leftPos + "%";
        countdown.innerText = Math.max(0, seconds);
        if (leftPos >= 85) clearInterval(progressIdx);
      }, 1000);
    }

    /* =========================================================
       âœ… 4. Download (PC ë‹¤ìš´ë¡œë“œ, ëª¨ë°”ì¼ ì €ì¥ í˜ì´ì§€)
       ========================================================= */
    function isMobile() {
      return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    }

    async function downloadCard() {
      const area = document.getElementById("captureArea");
      const mobile = isMobile();

      const scale = Math.max(3, Math.ceil(window.devicePixelRatio * 2));
      const canvas = await html2canvas(area, {
        backgroundColor: null,
        scale,
        useCORS: true,
      });

      const outCanvas = document.createElement("canvas");
      outCanvas.width = canvas.width;
      outCanvas.height = canvas.height;

      const ctx = outCanvas.getContext("2d");
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = "high";
      ctx.fillStyle = "#eff6ff";
      ctx.fillRect(0, 0, outCanvas.width, outCanvas.height);
      ctx.drawImage(canvas, 0, 0);

      const filename = "My_K-Identity.png";
      const dataUrl = outCanvas.toDataURL("image/png");

      if (!mobile) {
        const a = document.createElement("a");
        a.href = dataUrl;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
        return;
      }

      const page = `
<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Save your card</title>
  <style>
    body { margin:0; font-family: -apple-system, system-ui, sans-serif; background:#0b1220; color:#fff; }
    .wrap { max-width: 520px; margin: 0 auto; padding: 16px; }
    .card { background: #111827; border-radius: 18px; padding: 14px; }
    img { width: 100%; height: auto; border-radius: 14px; display:block; background:#eff6ff; }
    .btnrow { display:flex; gap:10px; margin-top:12px; }
    a.btn {
      flex:1; text-align:center; text-decoration:none;
      padding: 12px 10px; border-radius: 14px;
      font-weight: 800; font-size: 14px;
      background: #ec4899; color:#fff;
    }
    a.btn.secondary { background:#334155; }
    .hint { margin-top: 12px; font-size: 12px; opacity: .9; line-height: 1.45; }
    .hint strong { color:#fff; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <img src="${dataUrl}" alt="K-Identity Card">
      <div class="btnrow">
        <a class="btn" href="${dataUrl}" download="${filename}">Try Download</a>
        <a class="btn secondary" href="javascript:history.back()">Back</a>
      </div>
      <div class="hint">
        <div><strong>iPhone:</strong> Long-press the image above â†’ Save to Photos</div>
        <div style="margin-top:6px;"><strong>Android:</strong> Long-press the image â†’ Download image</div>
        <div style="margin-top:10px; opacity:.85;">
            â€» Depending on your browser, â€œTry Downloadâ€ may not work.<br>
            If so, please long-press the image to save it.
        </div>
      </div>
    </div>
  </div>
</body>
</html>`;

      document.open();
      document.write(page);
      document.close();
    }

    /* =========================================================
       âœ… 5. Buy/Share credit flow (ë¬¸ë²•/ë¹¨ê°„ì¤„ ì •ë¦¬)
       ========================================================= */
    let pendingCreditAmount = 0;
    let isWaitingForAction = false;

    function buyCredits(amount) {
      pendingCreditAmount = amount;
      isWaitingForAction = true;
    }

    function shareOnInsta() {
      window.open('https://instagram.com', '_blank');
      pendingCreditAmount = 3;
      isWaitingForAction = true;
    }

    function handleReturn() {
      if (!isWaitingForAction) return;
      isWaitingForAction = false;

      setTimeout(() => {
        const message = pendingCreditAmount >= 20 ? "purchase" : "sharing";
        const ok = confirm(
          "Welcome back! ğŸ¯\n" +
          `Did you complete the ${message}?\n` +
          `Click 'OK' to receive your ${pendingCreditAmount} credits!`
        );

        if (ok) {
          recharge(pendingCreditAmount);
          alert(`Success! ${pendingCreditAmount} credits added.`);
          closeRechargeModal();
        }
        pendingCreditAmount = 0;
      }, 500);
    }

    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'visible' && isWaitingForAction) handleReturn();
    });

    window.addEventListener('focus', () => {
      if (isWaitingForAction) handleReturn();
    });

    function startAdTimer() {
      const btn = document.getElementById('adBtn');
      let timeLeft = 30;
      btn.disabled = true;

      const interval = setInterval(() => {
        btn.innerText = `WAITING... ${timeLeft}s`;
        timeLeft--;

        if (timeLeft < 0) {
          clearInterval(interval);
          recharge(1);
          btn.innerText = "OR WATCH 30S AD FOR 1 CREDIT";
          btn.disabled = false;
          closeRechargeModal();
        }
      }, 1000);
    }

    /* =========================================================
       âœ… 6. Main Generation (URLSearchParamsë¡œ ë¹¨ê°„ì¤„ ë°©ì§€)
       ========================================================= */
    async function generate() {
      if (getCredits() <= 0) return showRechargeModal();
      const name = document.getElementById('engName').value.trim();
      if (!name) return alert("Please enter name!");

      document.getElementById('loading').classList.remove('hidden');
      document.getElementById('resultSection').classList.add('hidden');
      startTigerMotion();

      try {
        const params = new URLSearchParams({
          english_name: name,
          vibe: document.getElementById('vibe').value,
          gender: document.getElementById('gender').value,
          lang: document.getElementById('lang').value,
          strategy: document.getElementById('strategy').value,
        }).toString();

        const res = await fetch(`/api/generate-k-identity?${params}`);
        const data = await res.json();

        document.getElementById('kNameResult').innerText = data.k_name || "";
        document.getElementById('hanjaMeaning').innerText = data.meaning || "";
        document.getElementById('explainResult').innerText = data.explain || "";

        const imgElement = document.getElementById('aiImage');
        if (data.image_url) {
          imgElement.src = data.image_url;
          imgElement.classList.remove('hidden');
          document.getElementById('imagePlaceholder').classList.add('hidden');

          imgElement.onload = () => finishLoading();
          imgElement.onerror = () => {
            finishLoading();
            alert("Name is ready, but image failed to load.");
          };
        } else {
          finishLoading();
          alert("Name is ready, but image failed to load.");
        }

      } catch (e) {
        console.error("Fetch Error:", e);
        clearInterval(progressIdx);
        document.getElementById('loading').classList.add('hidden');
        alert("Server Busy! Please try once more.");
      }
    }

    function finishLoading() {
      clearInterval(progressIdx);
      document.getElementById('loading').classList.add('hidden');
      document.getElementById('resultSection').classList.remove('hidden');
      recharge(-1);
    }
  </script>
</body>
</html>
